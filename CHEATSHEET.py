#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å¿«é€Ÿå‚è€ƒå¡ - å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥ï¼ˆå«æ–­ç‚¹æ¥ç»­åŠŸèƒ½ï¼‰
"""

QUICK_COMMANDS = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    License Double-Check å¿«é€Ÿå‚è€ƒå¡                   â•‘
â•‘                      (å«æ–­ç‚¹æ¥ç»­åŠŸèƒ½ v2.0)                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â” åŸºç¡€å‘½ä»¤ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æœ€ç®€å•çš„ç”¨æ³•ï¼ˆè‡ªåŠ¨å¯ç”¨æ–­ç‚¹æ¥ç»­ï¼‰ï¼š
  python main.py "D:\\project"

â”â”â”â”â” æ–­ç‚¹æ¥ç»­ï¼ˆé‡ç£…åŠŸèƒ½ï¼ï¼‰â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â­ è‡ªåŠ¨å¯ç”¨ - ç¬¬ä¸€æ¬¡æ‰«æï¼š
  python main.py "D:\\huge_project" -t 16
  # æ‰«æ5000ä¸ªæ–‡ä»¶ï¼Œè¿è¡Œ2å°æ—¶åä¸­æ–­

ä¸­é€”ä¸­æ–­åï¼Œä½¿ç”¨ç›¸åŒå‘½ä»¤ç»§ç»­ï¼š
  python main.py "D:\\huge_project" -t 16
  # è‡ªåŠ¨åŠ è½½è¿›åº¦ï¼Œè·³è¿‡å·²æ‰«æçš„2500ä¸ªæ–‡ä»¶ï¼Œç»§ç»­å‰©ä½™çš„

âœ“ æ˜¾å¼å¯ç”¨æ–­ç‚¹æ¥ç»­ï¼š
  python main.py "D:\\project" --resume

âœ— è·³è¿‡æ–­ç‚¹æ¥ç»­ï¼Œé‡æ–°æ‰«ææ‰€æœ‰æ–‡ä»¶ï¼š
  python main.py "D:\\project" --skip-resume

ğŸ”„ é‡ç½®è¿›åº¦æ–‡ä»¶ï¼ˆåˆ é™¤å·²ä¿å­˜è¿›åº¦ï¼‰ï¼š
  python main.py "D:\\project" --reset

ğŸ“ ä½¿ç”¨è‡ªå®šä¹‰è¿›åº¦æ–‡ä»¶ï¼š
  python main.py "D:\\project" -p my_progress.json

â”â”â”â”â” å¸¸ç”¨å˜ä½“ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. å¢åŠ çº¿ç¨‹æ•°ï¼ˆåŠ é€Ÿæ‰«æï¼‰ï¼š
   python main.py "D:\\project" -t 32

2. è‡ªå®šä¹‰è¾“å…¥è¾“å‡ºæ–‡ä»¶ï¼š
   python main.py "D:\\project" -i source.xlsx -o results.xlsx

3. è‡ªå®šä¹‰è·¯å¾„åˆ—åï¼š
   python main.py "D:\\project" -c file_path

4. å®Œæ•´å‚æ•°ç¤ºä¾‹ï¼š
   python scan_licenses.py "D:\\project" \\
     -i input.xlsx \\
     -o output.xlsx \\
     -t 16 \\
     -c path \\
     -p progress.json \\
     --resume

â”â”â”â”â” å¿«é€Ÿå‡†å¤‡ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ç”Ÿæˆç¤ºä¾‹è¾“å…¥æ–‡ä»¶ï¼š
  python create_sample.py

æŸ¥çœ‹å¸®åŠ©ï¼š
  python scan_licenses.py --help

æŸ¥çœ‹æ–­ç‚¹æ¥ç»­è¯¦ç»†è¯´æ˜ï¼š
  type RESUME.md

â”â”â”â”â” å®é™…å·¥ä½œæµ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åœºæ™¯ï¼šæ‰«æç†æƒ³æ±½è½¦é¡¹ç›®çš„æ‰€æœ‰æºæ–‡ä»¶

# ç¬¬ä¸€å¤©ï¼šå¼€å§‹æ‰«æ
python main.py "D:\\OneDrive\\æ–‡æ¡£\\...\\haloosspace" -t 16
# è¿è¡Œ3å°æ—¶ï¼Œå®Œæˆ2000ä¸ªæ–‡ä»¶

# ä¸­é€”ä¸­æ–­ï¼ˆæŒ‰ Ctrl+Cï¼‰

# ç¬¬äºŒå¤©ï¼šæ¢å¤æ‰«æï¼ˆç›´æ¥è¿è¡Œç›¸åŒå‘½ä»¤ï¼‰
python main.py "D:\\OneDrive\\æ–‡æ¡£\\...\\haloosspace" -t 16
# è‡ªåŠ¨æ˜¾ç¤ºï¼šâœ“ å·²åŠ è½½è¿›åº¦æ–‡ä»¶ï¼ŒåŒ…å« 2000 ä¸ªå·²æ‰«ææ–‡ä»¶
# è‡ªåŠ¨æ˜¾ç¤ºï¼šâœ“ è·³è¿‡äº† 2000 ä¸ªå·²æ‰«ææ–‡ä»¶ï¼Œæœ¬æ¬¡éœ€æ‰«æ 3000 ä¸ª
# ç»§ç»­æ‰«æå‰©ä½™çš„3000ä¸ªæ–‡ä»¶...

# å®Œæˆå
# æŸ¥çœ‹æ—¥å¿—
type scan_licenses_*.log

# æŸ¥çœ‹è¿›åº¦
type scan_progress.json

# æŸ¥çœ‹ç»“æœ
# æ‰“å¼€ output.xlsx

â”â”â”â”â” å‚æ•°é€ŸæŸ¥è¡¨ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ä½ç½®å‚æ•°ï¼š
  path_prefix                  æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å‰ç¼€ [å¿…éœ€]

æ–‡ä»¶ç›¸å…³å‚æ•°ï¼š
  -i, --input FILE             è¾“å…¥Excelæ–‡ä»¶ [é»˜è®¤: input.xlsx]
  -o, --output FILE            è¾“å‡ºExcelæ–‡ä»¶ [é»˜è®¤: output.xlsx]
  -c, --column NAME            è·¯å¾„åˆ—åˆ—å [é»˜è®¤: path]

æ‰§è¡Œç›¸å…³å‚æ•°ï¼š
  -t, --threads NUM            å¹¶è¡Œçº¿ç¨‹æ•° [é»˜è®¤: 4]

æ–­ç‚¹æ¥ç»­å‚æ•°ï¼š
  -p, --progress-file FILE     è¿›åº¦æ–‡ä»¶ä½ç½® [é»˜è®¤: scan_progress.json]
  --resume                     å¯ç”¨æ–­ç‚¹æ¥ç»­ [é»˜è®¤å¯ç”¨]
  --skip-resume                è·³è¿‡æ–­ç‚¹æ¥ç»­ï¼Œé‡æ–°æ‰«ææ‰€æœ‰
  --reset                      é‡ç½®è¿›åº¦æ–‡ä»¶å¹¶é€€å‡º

â”â”â”â”â” åœºæ™¯ç¤ºä¾‹ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åœºæ™¯A - ç†æƒ³æ±½è½¦é¡¹ç›®ï¼ˆé»˜è®¤å¯ç”¨æ–­ç‚¹æ¥ç»­ï¼‰ï¼š
  python main.py "D:\\OneDrive\\æ–‡æ¡£\\...\\haloosspace"

åœºæ™¯B - å¤§å‹é¡¹ç›®åŠ é€Ÿï¼ˆ32çº¿ç¨‹ + æ–­ç‚¹æ¥ç»­ï¼‰ï¼š
  python main.py "D:\\huge_project" -t 32

åœºæ™¯C - ä¸­æ–­åç»§ç»­ï¼ˆå®Œå…¨è‡ªåŠ¨ï¼Œåªéœ€è¿è¡Œç›¸åŒå‘½ä»¤ï¼‰ï¼š
  python main.py "D:\\huge_project" -t 32

åœºæ™¯D - å®Œå…¨é‡æ–°æ‰«æï¼ˆè·³è¿‡æ–­ç‚¹æ¥ç»­ï¼‰ï¼š
  python main.py "D:\\project" --skip-resume

åœºæ™¯E - è‡ªå®šä¹‰è¿›åº¦æ–‡ä»¶ï¼ˆå¤šé¡¹ç›®å¹¶è¡Œï¼‰ï¼š
  # é¡¹ç›®1è¿›åº¦
  python main.py "D:\\project1" -p progress1.json -t 8
  
  # é¡¹ç›®2è¿›åº¦ï¼ˆä¸åŒçš„è¿›åº¦æ–‡ä»¶ï¼‰
  python main.py "D:\\project2" -p progress2.json -t 8

â”â”â”â”â” è¿›åº¦æ–‡ä»¶ç®¡ç† â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ç”Ÿæˆä½ç½®ï¼š
  é»˜è®¤ï¼šscan_progress.jsonï¼ˆå½“å‰ç›®å½•ï¼‰
  è‡ªå®šä¹‰ï¼špython main.py "D:\\project" -p D:\\my_progress.json

æŸ¥çœ‹æ–‡ä»¶ï¼š
  type scan_progress.json

æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š
  {
    "0": {
      "file_path": "D:\\project\\file1.cpp",
      "license_expression_spdx": "MIT",
      "error": null
    },
    "1": {
      "file_path": "D:\\project\\file2.h",
      "license_expression_spdx": "Apache-2.0",
      "error": null
    }
  }

é‡ç½®è¿›åº¦ï¼š
  python main.py "D:\\project" --reset

â”â”â”â”â” è¾“å…¥è¾“å‡ºæ ¼å¼ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è¾“å…¥æ ¼å¼ (input.xlsx)ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ path                                      â”‚ file_name   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ src/main.cpp                              â”‚ main.cpp    â”‚
â”‚ lib/util.h                                â”‚ util.h      â”‚
â”‚ third_party/boost/config.hpp              â”‚ config.hpp  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¾“å‡ºæ ¼å¼ (output.xlsx)ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ path                                 â”‚ license_expression_spdx... â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ src/main.cpp                         â”‚ MIT                        â”‚
â”‚ lib/util.h                           â”‚ Apache-2.0                 â”‚
â”‚ third_party/boost/config.hpp         â”‚ BSL-1.0                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”â”â”â”â” è¿›åº¦æ—¥å¿—ç¤ºä¾‹ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

é¦–æ¬¡æ‰«æï¼š
  âœ“ å¯ç”¨æ–­ç‚¹æ¥ç»­åŠŸèƒ½ï¼ˆè¿›åº¦æ–‡ä»¶: scan_progress.jsonï¼‰
  éœ€è¦æ‰«æçš„æ–‡ä»¶æ•°: 5000

ä¸­æ–­åç»§ç»­ï¼š
  âœ“ å·²åŠ è½½è¿›åº¦æ–‡ä»¶ï¼ŒåŒ…å« 2500 ä¸ªå·²æ‰«ææ–‡ä»¶
  âœ“ è·³è¿‡äº† 2500 ä¸ªå·²æ‰«ææ–‡ä»¶ï¼Œæœ¬æ¬¡éœ€æ‰«æ 2500 ä¸ª
  è¿›åº¦: 1/2500 (æ€»å·²æ‰«æ: 2501)
  è¿›åº¦: 2/2500 (æ€»å·²æ‰«æ: 2502)
  
æ‰«æå®Œæˆï¼š
  å·²æ‰«ææ–‡ä»¶æ•°: 5000
  æ£€æµ‹åˆ°licenseçš„æ–‡ä»¶æ•°: 4800
  æœªæ£€æµ‹åˆ°licenseçš„æ–‡ä»¶æ•°: 200
  âœ“ æ‰€æœ‰æ–‡ä»¶æ‰«æå®Œæˆï¼

â”â”â”â”â” æ€§èƒ½å»ºè®® â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

çº¿ç¨‹æ•°é€‰æ‹©ï¼š
  CPU 4æ ¸  â†’ -t 4  (é»˜è®¤ï¼Œè¾ƒä¿å®ˆ)
  CPU 8æ ¸  â†’ -t 8  æˆ– -t 16 (å¹³è¡¡)
  CPU 16æ ¸ â†’ -t 16 æˆ– -t 32 (æ¿€è¿›)

ä¼°è®¡æ—¶é—´ï¼ˆå•ä¸ªå°æ–‡ä»¶1-2ç§’ï¼‰ï¼š
  100æ–‡ä»¶ + 4çº¿ç¨‹   ~ 5-10åˆ†é’Ÿ
  100æ–‡ä»¶ + 16çº¿ç¨‹  ~ 2-3åˆ†é’Ÿ
  1000æ–‡ä»¶ + 16çº¿ç¨‹ ~ 20-30åˆ†é’Ÿ
  1000æ–‡ä»¶ + 32çº¿ç¨‹ ~ 10-15åˆ†é’Ÿ

æ–­ç‚¹æ¥ç»­ä¼˜åŠ¿ï¼š
  âœ“ ä¸­é€”ä¸­æ–­å¯å®‰å…¨ç»§ç»­ï¼Œæ— æ•°æ®ä¸¢å¤±
  âœ“ è‡ªåŠ¨è·³è¿‡å·²æ‰«ææ–‡ä»¶ï¼Œçœæ—¶é—´
  âœ“ æ”¯æŒæ”¹å˜çº¿ç¨‹æ•°ç»§ç»­æ‰«æ
  âœ“ å¯å¹¶è¡Œæ‰«æå¤šä¸ªé¡¹ç›®

â”â”â”â”â” å¸¸è§é—®é¢˜ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ scancode.bat æ‰¾ä¸åˆ°ï¼Ÿ
  â†’ æ£€æŸ¥: scancode.bat --version
  â†’ é‡æ–°å®‰è£…ScanCodeæˆ–æ·»åŠ åˆ°PATH

âŒ å†…å­˜å ç”¨è¿‡é«˜ï¼Ÿ
  â†’ å‡å°‘çº¿ç¨‹: -t 2 æˆ– -t 4

âŒ æ‰«æå¾ˆæ…¢ï¼Ÿ
  â†’ å¢åŠ çº¿ç¨‹: -t 16 æˆ– -t 32

âŒ æƒ³é‡æ–°æ‰«ææ‰€æœ‰æ–‡ä»¶ï¼Ÿ
  â†’ pip main.py "D:\\project" --skip-resume
  â†’ æˆ–ï¼špython main.py "D:\\project" --reset

âŒ ä¸­æ–­åæ‰¾ä¸åˆ°è¿›åº¦ï¼Ÿ
  â†’ æ£€æŸ¥ scan_progress.json æ˜¯å¦å­˜åœ¨
  â†’ æŸ¥çœ‹æ—¥å¿—äº†è§£è¯¦æƒ…ï¼štype scan_licenses_*.log

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ–‡ä»¶è¯´æ˜ï¼š
  scan_licenses.py  â† æ ¸å¿ƒè„šæœ¬ï¼ˆå«æ–­ç‚¹æ¥ç»­ï¼‰
  main.py          â† å…¥å£è„šæœ¬
  create_sample.py â† ç”Ÿæˆç¤ºä¾‹
  RESUME.md        â† æ–­ç‚¹æ¥ç»­è¯¦ç»†æ–‡æ¡£ â­ æ–°å¢

ä¾èµ–åº“ï¼š
  pandas >= 3.0.0      âœ“ å·²å®‰è£…
  openpyxl >= 3.0.0    âœ“ å·²å®‰è£…

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š æ›´å¤šæ–‡æ¡£ï¼š
  python scan_licenses.py --help  # å‘½ä»¤å¸®åŠ©
  type README.md                  # é¡¹ç›®æ¦‚è¿°
  type USAGE.md                   # è¯¦ç»†ä½¿ç”¨æŒ‡å—
  type RESUME.md                  # æ–­ç‚¹æ¥ç»­è¯´æ˜ â­
  type SUMMARY.md                 # æŠ€æœ¯æ€»ç»“
"""

if __name__ == "__main__":
    print(QUICK_COMMANDS)
    
    # æ‰“å°æ¨èæ­¥éª¤
    print("\nğŸ’¡ æ¨èé¦–æ¬¡ä½¿ç”¨æ­¥éª¤ï¼š")
    print("  1. python create_sample.py")
    print("  2. python main.py \"D:\\your\\project\" -t 4")
    print("  3. type scan_licenses_*.log  # æŸ¥çœ‹æ—¥å¿—")
    print("  4. type scan_progress.json   # æŸ¥çœ‹æ‰«æè¿›åº¦")
    print("  5. # æ‰“å¼€ output.xlsx æŸ¥çœ‹ç»“æœ")
    print("\nğŸ’¡ å¤§é¡¹ç›®å»ºè®®ï¼š")
    print("  1. python main.py \"D:\\huge_project\" -t 32")
    print("  2. # ä¸­é€”ä¸­æ–­æ—¶æŒ‰ Ctrl+C")
    print("  3. # é‡æ–°è¿è¡Œç›¸åŒå‘½ä»¤ç»§ç»­")
    print("\nğŸ“– äº†è§£æ›´å¤šï¼š")
    print("  type RESUME.md  # æŸ¥çœ‹æ–­ç‚¹æ¥ç»­è¯¦ç»†è¯´æ˜")
