"""
快速开始指南和示例
"""

# ============================================================
# 使用方法
# ============================================================

# 1. 创建input.xlsx文件
# 格式示例参考README.md

# 2. 运行扫描任务（选择其中一种方式）

# 方式A: 使用main.py
# python main.py "D:\path\to\project" -i input.xlsx -o output.xlsx

# 方式B: 直接使用scan_licenses.py
# python scan_licenses.py "D:\path\to\project"\
#   -i input.xlsx \
#   -o output.xlsx \
#   -t 8

# ============================================================
# 完整示例
# ============================================================

# 假设你的项目结构为：
# haloosspace/
#   ├── vbs/
#   │   └── vbspro/
#   │       └── thirdparty/
#   │           └── boost/
#   │               └── include/
#   │                   └── boost/
#   │                       └── config/
#   │                           └── abi/
#   │                               └── msvc_prefix.hpp

# input.xlsx包含：
# | path |
# | vbs/vbspro/thirdparty/boost/include/boost/config/abi/msvc_prefix.hpp |
# | ... |

# 运行命令：
# python main.py "D:\OneDrive\文档\0工作资料\国浩工作资料\自有案件\开源合规专项——理想汽车\haloosspace"

# output.xlsx会包含additional列:
# | path | license_expression_spdx_scancode |
# | vbs/vbspro/thirdparty/boost/include/boost/config/abi/msvc_prefix.hpp | BSL-1.0 |

# ============================================================
# 功能特点
# ============================================================

# 1. 多线程并行扫描
#    - 默认使用4个线程
#    - 可通过 -t 参数调整线程数
#    - 例: -t 16 使用16个线程并行扫描

# 2. 详细日志记录
#    - 创建 scan_licenses_YYYYMMDD_HHMMSS.log
#    - 包含扫描进度和错误信息
#    - 同时输出到控制台和日志文件

# 3. 错误处理
#    - 自动跳过不存在的文件（记录警告）
#    - 扫描失败时记录错误信息
#    - 5分钟扫描超时保护

# 4. 临时文件管理
#    - 自动创建临时目录存储JSON
#    - 扫描完成后自动清理

# ============================================================
# 常用命令示例
# ============================================================

# 示例1: 扫描项目中的所有文件（4个线程）
# python main.py "D:\my_project"

# 示例2: 增加线程数提高速度（16个线程）
# python scan_licenses.py "D:\my_project" -t 16

# 示例3: 自定义输入输出文件
# python main.py "D:\my_project" \
#     -i files_to_check.xlsx \
#     -o license_results.xlsx

# 示例4: 自定义路径列名
# python scan_licenses.py "D:\my_project" \
#     -c "file_path" \
#     -i input.xlsx \
#     -o output.xlsx

# ============================================================
# 输出示例
# ============================================================

# 控制台输出：
# 2026-02-10 15:30:45,123 - INFO - ============================================================
# 2026-02-10 15:30:45,124 - INFO - 开始license扫描任务
# 2026-02-10 15:30:45,125 - INFO - 输入文件: input.xlsx
# 2026-02-10 15:30:45,126 - INFO - 输出文件: output.xlsx
# 2026-02-10 15:30:45,127 - INFO - 路径前缀: D:\my_project
# 2026-02-10 15:30:45,128 - INFO - 并行线程数: 4
# 2026-02-10 15:30:45,200 - INFO - 准备扫描 50 个文件
# 2026-02-10 15:30:50,300 - INFO - 开始扫描文件: D:\my_project\file1.cpp
# 2026-02-10 15:31:00,400 - INFO - 文件 D:\my_project\file1.cpp 扫描完成，检测到license: BSL-1.0
# ...
# 2026-02-10 15:45:20,500 - INFO - ✓ 扫描完成！
# 2026-02-10 15:45:20,502 - INFO - 总扫描文件数: 50
# 2026-02-10 15:45:20,503 - INFO - 检测到license的文件数: 48
# 2026-02-10 15:45:20,504 - INFO - 未检测到license的文件数: 2

# ============================================================
# 故障排查
# ============================================================

# 问题1: "scancode.bat" 命令找不到
# 解决: 运行 scancode.bat --version 检查是否正确安装
#     确保已添加到系统PATH

# 问题2: 文件权限不足
# 解决: 以管理员身份运行CMD/PowerShell

# 问题3: 某个文件扫描超时
# 解决: 查看日志文件（.log）了解详情
#     该文件会被跳过，处理继续

# 问题4: 内存占用过多
# 解决: 减少线程数，例如 -t 2
